//
//  testmplbbreak.c
//  Morphy
//
//  Created by Martin Brazeau on 15/01/2019.
//  Copyright Â© 2019 Martin Brazeau. All rights reserved.
//
#include "mpltest.h"
#include "testutils.h"

#include "testmplbbreak.h"
#include "../src/Trees/mpl_node.h"
#include "../src/Trees/mpl_tree.h"
#include "../src/Trees/mpl_topol.h"
#include "../src/Trees/mpl_newick_rdr.h"
#include "../src/Characters/mpl_matrix.h"
#include "../src/Analysis/mpl_scoretree.h"

int test_bbreak_reroot_all_for_subtree (void)
{
    theader("Test rerooting of a subtree");
    
    int failn = 0;
    
    // Set up a tree
    long numtaxa = 10;
    char* nwkstring = "((((1,((2,7),(5,9))),(4,8)),6),(3,10));";
    
    mpl_newick_rdr nwkrdr;
    mpl_topol top;
    top.num_taxa = 1;
    top.edges = NULL;
    mpl_topol_reset(numtaxa, &top);
    
    mpl_newick_rdr_init(numtaxa, &nwkrdr);
    mpl_newick_read(nwkstring, &top, &nwkrdr);
    
    mpl_tree* t = mpl_new_tree(numtaxa);
    
    mpl_tree_read_topol(t, &top);
    
    char* nwkout = NULL;
    mpl_tree_write_newick(&nwkout, t);
    printf("Original tree:\t\t\t%s\n", nwkout);
    free(nwkout);
    
    // Clip a 'non-trivial' branch
    mpl_node* src = NULL;
    mpl_node* clipsite = NULL;
    
    mpl_node* toleft = NULL;
    mpl_node* toright = NULL;
    //   Using ancestor of the ancestor of tip 2 which shoudl be the subtree
    //   ((2,7),(5,9))
    src = t->nodes[1].anc->anc;
    clipsite = mpl_node_get_sib(src);
    
    if (src->anc->left == clipsite) {
        toleft = clipsite;
    }
    else {
        toright = clipsite;
    }
    
    mpl_node* sites[10];
    mpl_node** s, **sn;
    
    s = sites;
    sites[0] = src->left;
    sites[1] = src->right->left;
    sites[2] = src->right->right;
    sn = &sites[3];
    
    for (s = sites; s < sn; ++s) {
        
        // Clip the node
        mpl_node_bin_clip(src);
        
        // Perform a rerooting
        mpl_test_bbreak_tbr_reroot(*s, src);
        
        if (!(*s)->tip) {
            *sn = (*s)->left;
            ++sn;
            *sn = (*s)->right;
            ++sn;
        }
        
        // Reconnect and print the tree
        mpl_node_bin_connect(toleft, toright, src);
        
        mpl_tree_write_newick(&nwkout, t);
        printf("With rerooted subtree:\t%s\n", nwkout);
        free(nwkout);
        nwkout = NULL;
        
        if (mpl_tree_checker(t)) {
            ++failn;
            pfail;
        }
        else {
            ppass;
        }
    }

    return failn;
}

int test_bbreak_store_allswaps (void)
{
    theader("Test making a list of all SPR rearrangements");
    
    int failn = 0;
    
    // Set up a tree
    long numtaxa = 10;
    char* nwkstring = "((((1,((2,7),(5,9))),(4,8)),6),(3,10));";
    
    mpl_newick_rdr nwkrdr;
    mpl_topol top;
    top.num_taxa = 1;
    top.edges = NULL;
    mpl_topol_reset(numtaxa, &top);
    
    mpl_newick_rdr_init(numtaxa, &nwkrdr);
    mpl_newick_read(nwkstring, &top, &nwkrdr);
    
    mpl_tree* t = mpl_new_tree(numtaxa);
    mpl_tree_read_topol(t, &top);
    mpl_tree_rebase(0, t);
    
    char* nwkout = NULL;
    mpl_tree_write_newick(&nwkout, t);
    printf("Original tree:\t\t\t%s\n", nwkout);
    free(nwkout);
    
    // Declare and initialise a bbreak struct
    // For now: manually set parameters in the search and bbreak structs
    mpl_search s;
    s.treelist = mpl_treelist_new(10, 1000, 0);
    
    s.bbreak_type = MPL_SPR_T;
    
    mpl_bbreak bbk;
    // The number of nodes in the bbreak will be the size of the tree
    mpl_tree_traverse(t);
    bbk.num_nodes = t->size;
    // Now the bbkreak struct can be initialised
    mpl_bbreak_init(&s, &bbk);
    
    mpl_test_branch_swap(t, &bbk);
    
    int i = 0;
    for (i = 0; i < bbk.treelist->num_trees; ++i) {
        mpl_tree_read_topol(t, &bbk.treelist->trees[i]);
        mpl_tree_write_newick(&nwkout, t);
        printf("TREE Morphy_%i\t=\t[&U] %s\n", (i + 1), nwkout);
        free(nwkout);
    }
    
    return failn;
}


int test_bbreak_store_TBR_allswaps (void)
{
    theader("Test making a list of all SPR rearrangements");
    
    int failn = 0;
    
    // Set up a tree
    long numtaxa = 24;
    char* nwkstring = "(1,(((((2,3),6),(12,((7,(8,9)),(10,11)))),4),((19,((20,21),(((13,5),(14,15)),(16,(17,18))))),(22,(23,24)))));";
    
    mpl_newick_rdr nwkrdr;
    mpl_topol top;
    top.num_taxa = 1;
    top.edges = NULL;
    mpl_topol_reset(numtaxa, &top);
    
    mpl_newick_rdr_init(numtaxa, &nwkrdr);
    mpl_newick_read(nwkstring, &top, &nwkrdr);
    
    mpl_tree* t = mpl_new_tree(numtaxa);
    mpl_tree_read_topol(t, &top);
    mpl_tree_rebase(0, t);
    
    char* nwkout = NULL;
    mpl_tree_write_newick(&nwkout, t);
    printf("Original tree: %s\n", nwkout);
    free(nwkout);
    
    // Declare and initialise a bbreak struct
    // For now: manually set parameters in the search and bbreak structs
    mpl_search s;
    s.treelist = mpl_treelist_new(numtaxa, 20000, 0);
    
    s.bbreak_type = MPL_TBR_T;
    
    mpl_bbreak bbk;
    // The number of nodes in the bbreak will be the size of the tree
    mpl_tree_traverse(t);
    bbk.num_nodes = t->size;
    // Now the bbkreak struct can be initialised
    mpl_bbreak_init(&s, &bbk);
    
    mpl_test_branch_swap(t, &bbk);
    
//    int i = 0;
//    for (i = 0; i < bbk.treelist->num_trees; ++i) {
//        mpl_tree_read_topol(t, &bbk.treelist->trees[i]);
//        mpl_tree_write_newick(&nwkout, t);
//        printf("TREE Morphy_%i\t=\t[&U] %s\n", (i + 1), nwkout);
//        free(nwkout);
//    }
    
    printf("\nTBR complete. %li rearrangements tried\n", bbk.num_rearrangs);
    
    return failn;
}


int test_single_rep_hsearch (void)
{
    theader("Test single-replicate heuristic search");
    
    int failn = 0;

    int ntax = 23;
    int nchar = 57;

    int hold = 5; // Hold up to 3 trees
    
    char* rawmatrix =

// Vinther
    "1010?10?0-0000000000000000000000000000-00-00-00000-0000-0\
    111111110-111?010111111111111?10000000-00-00-00000-0000-0\
    111111110-1111010111111011101010000000-00-00-00000-0000-0\
    111111110-1110010111100000001000000000-00-00-00000-0000-0\
    111111110-1111110111111111111010000000-00-00-00000-0000-0\
    111111110-1111010111?00000001000000000-00-00-00000-0000-0\
    1110111111?000000000000000000001110001010000-00000-000?-0\
    1110111111?000000000000000000001111001010000-00000-0001-0\
    111001111110000000000000000000012210010110010000002010111\
    ?1???11?100?00000000001000000001221000-00-0100000000001-0\
    100000000-1100000000000000000000000110-00-011001001000020\
    100000000-1100000000000000000000000110-00-012101001000020\
    ??????????1?????011??????????????00000-00-011000103301010\
    ????????????????1?1?????????????????00-00-011000103301010\
    ????????????????1?1?????????????????00-00-011000113301010\
    ??????????1??01?011?101000000000000000-00-00-00000-0000-0\
    ??????????????0?000?000?000000?????00101?11100000020?0?1?\
    ??????????????0?000?000?000000?????00101?1110000102210111\
    ??????????????0?000?000?000000???110010100010000002000100\
    ??????????????0?000?000?000000?????001011101??000010?000?\
    ??????????1???0?000?000?000000010??0011?1?00-00000-0000-0\
    ??????????????0?000?000?000000?????001??1101???000000000?\
    ??????????????0?000?000000000001021000-00-00-00000-0000-0;";


    mpl_matrix* m = mpl_matrix_new();
    mpl_matrix_set_nrows(ntax, m);
    mpl_matrix_set_ncols(nchar, m);
    mpl_matrix_set_nnodes(2 * ntax, m);
    mpl_matrix_attach_rawdata(rawmatrix, m);
//    mpl_matrix_set_gap_handle(GAP_MISSING, m);
    mpl_matrix_apply_data(m);
    mpl_init_parsimony(m);
    
    mpl_search s;
    s.treelist = mpl_treelist_new(ntax, 100000, 0);
    s.num_taxa = ntax;
    s.bbreak_type = MPL_TBR_T;
    
    mpl_bbreak bbk;
    // The number of nodes in the bbreak will be the size of the tree
    bbk.num_nodes = 2 * ntax-1;
    // Now the bbkreak struct can be initialised
    mpl_bbreak_init(&s, &bbk);
    bbk.bbktype = MPL_TBR_T;
    bbk.numreps = 10;
//    bbk.bbktype = MPL_SPR_T;
    mpl_do_bbreak(&bbk);
    
    mpl_tree* t  = mpl_new_tree(ntax);
    mpl_topol* top = NULL;
    char* nwkresult = NULL;
    int i = 0;
    
    for (i = 0; i < bbk.treelist->num_trees; ++i) {
        top =  mpl_treelist_get_topol(i, bbk.treelist);
        mpl_tree_read_topol(t, top);

        mpl_tree_write_newick(&nwkresult, t);
        printf("TREE Morphy_%i = [&U] %s [length: %.0f]\n", i+1, nwkresult, top->score);
        free(nwkresult);
    }
    
    if (bbk.shortest != 79.0) {
        ++failn;
        pfail;
    }
    else {
        ppass;
    }
    
    if (bbk.treelist->num_trees != 52) {
        ++failn;
        pfail;
    }
    else {
        ppass;
    }
    
    return failn;
}


int test_mutliple_replicate_heuristic_search (void)
{
    theader("Test multiple addition sequence searches");
    
    int failn = 0;

    int ntax = 23;
    int nchar = 126;
    
    int hold = 5; // Hold up to 3 trees
    
    char* rawmatrix =
    "00010100100011011010011100020000-000011000101000111011?1-110?11010??0010000000100400000-02301?10001010101001000000010111101010\
    111?10-0101011001110000120021101100101000100001-100-10000000011011302011000001--1000000-02210000010201-00010-10100011000000000\
    100-01001?000-011110101021021110-00000000001-101010?11201001?10010310110211010112111100-?21000010?100000010110001010-011101110\
    00010100100010011111011100020000-000011000101?0?11101101-011?110?03300100000?0100400000-02301?10011000101001000000010111101010\
    111010-010000-00?000000120020000-00001000001-01-110210000000101011412000001110111000010-0121010101000000000100010000-0000000?0\
    0001000100010-001010100120020010-10001001010110001111121-001011010212110211101--221110111-2001010100000000010?010010-010000010\
    1001111110001000001000102012121?0001000101100001110110000101110111300110000001--1001000-?2200101010000100000-11-00011100001000\
    100?000010?0110110101000200200??01001001010010011101102000001111103100100000000-0301000-02210101020000000010-1000000-011011001\
    ?????????????????????????????????????????????0??0???11???100?????021011020110010???1101100???????????????????????????????????0\
    0001001100101000001011102002001110?101001010100001101121-11011101021001021111010030110110020000001000000001101010000-011000??1\
    001110-11010110010101?0120020001100001001000110001111121-201?1001131?000211110111100100-0120010101000000000100010110-011000010\
    ????????????????????1110000200?1101100001010100101100-21-10121101031011021111010210110110011000001000000000100010000-011001010\
    000?000100101000101011102002001110?100001010100?01101121-10111101031?01021111010210110110011000101000000100100010000-011001010\
    00010001101010101110101010110001101101001010100101100-21-1012110103101102011101021?1101101310000010201-1-011000100011011101010\
    101011-??00011001?00000121020000-00001000000000101011000010010000-0--000-00-01-?0-00000-1-20010111000000000100000001110001001-\
    ????????????????????111020020011100000001010100001101?21-10111001131201021111010110110110011000101000000000100010000-011001010\
    ?????????????????????????????????????????0?????????????1-110?????022?01021111010????1????????????????????????????????????????1\
    01000001101010101110101010110001101?01001010101-01100-01-1012100?031011010111010210100100?210000010201-1-010-00000011011011010\
    111010-1?000110?111001010002110110000011?120001-0111100000001002001101100000000-2211000-01210100111201-1-010-1000100-000000000\
    ????????????????????????????????????????????????????10?1-100???0?????01020111010??011011003???0???????????????????????????????\
    00000001001111001110100120020011110001001010110001111121-?010110102121102110001112111011022001010100000000010?010010-01100001?\
    100?0?0??00011011010011100020000-000001000101000111?11?1-110???010310010000000100400000-02301010001010101001000000010111101010\
    101?10-10010110010101?0?20020001110001001000110001111121-101110011?12110211000111?1110110?20010101000000000101010110-011000010;";
    
    mpl_matrix* m = mpl_matrix_new();
    mpl_matrix_set_nrows(ntax, m);
    mpl_matrix_set_ncols(nchar, m);
    mpl_matrix_set_nnodes(2 * ntax, m);
    mpl_matrix_attach_rawdata(rawmatrix, m);
    //    mpl_matrix_set_gap_handle(GAP_MISSING, m);
    mpl_matrix_apply_data(m);
    mpl_init_parsimony(m);
    
    mpl_search s;
    s.treelist = mpl_treelist_new(ntax, 100000, 0);
    s.num_taxa = ntax;
    s.bbreak_type = MPL_TBR_T;
    
    mpl_bbreak bbk;
    // The number of nodes in the bbreak will be the size of the tree
    bbk.num_nodes = 2 * ntax-1;
    // Now the bbkreak struct can be initialised
    mpl_bbreak_init(&s, &bbk);
    bbk.bbktype = MPL_TBR_T;
    bbk.numreps = 10;
    //    bbk.bbktype = MPL_SPR_T;
    mpl_do_bbreak(&bbk);
    
    mpl_tree* t  = mpl_new_tree(ntax);
    mpl_topol* top = NULL;
    char* nwkresult = NULL;
    int i = 0;
    
    for (i = 0; i < bbk.treelist->num_trees; ++i) {
        top =  mpl_treelist_get_topol(i, bbk.treelist);
        mpl_tree_read_topol(t, top);

        mpl_tree_write_newick(&nwkresult, t);
        printf("TREE Morphy_%i = [&U] %s [length: %.0f]\n", i+1, nwkresult, top->score);
        free(nwkresult);
    }
    
    if (bbk.shortest != 345.0) {
        ++failn;
        pfail;
    }
    else {
        ppass;
    }
    
    if (bbk.treelist->num_trees != 31) {
        ++failn;
        pfail;
    }
    else {
        ppass;
    }
    
    return failn;
}


int test_ratchet_search (void)
{
    theader("Test parsimony ratchet search");
    
    int failn = 0;
    //Miyashita et al:
    //    int ntax = 52;
    //    int nchar = 168;
    //  hbw:
    int ntax = 91;
    int nchar = 453;

    int hold = 5; // Hold up to 3 trees
    
    char* rawmatrix =
    //Miyashita et al.
    //"00---------0-0-0---------0----------0-00--0--------00-----0-00-10------0-000-0--20-------0----0----------------------------------------------------0-------0---0--000---\
    0000---000-1-0-0---------0------0---0-00--0----0-0-00-----1000-11------0-001-0--1000-2000100000-----00---------------------------------00-0-----0-00---0--000--0-0010---\
    01-0---0---1-0-0---0-----0------0---0-00--0----0---01-------00--0------01000-0----00-20--0--000----------------------------------------0-----------0---0---0---1---10---\
    00?0-?????????-0---------0------0-?????????----?-???0??---?-01-?0------?????????10?0-?0-01000?0-----??---------------------------------?0-???---?-?0---????0?????0000---\
    01??????????????????-----10????00-?????????----1-???0?000100?1-11????--?????????0000-?0001000?0-----??---------------------------------?0-0--?--0-0????0-0?00????0000---\
    ?1??????????????????-----??????????????????00--1???10?0??00?00-??0???--?????????00?1-00001000?0-----??---------------------------------???????--?-0????????0??????010---\
    ?10???????????0100?1-----10????00-?????????00--111??0?00010?00-100???--?????????00?0-??000--0?0-----??---------------------------------00-0--0--0-0????100?00???01010---\
    ?10???????????010001-----10????01??????????00--111??0?00010??0-100???--?????????1011-00001000?0-----??---------------------------------00-0--0--0-01?1?0-0?00????1?10---\
    11??????????????????-----10????01??????????210-????10?1??0010?-0?????--?????????1010-20?00--0?0-----??---------------------------------?110-?00-0-?????????10????1?10---\
    ?11?????????????????-----10????01??????????20--????10?1001000?-0?0???--?????????10?0-?0?00--010-----??---------------------------------?0-11??-?0-????????000????1?10---\
    ?10?????????????????-----10????0???????????0---???????1??00???-??0???--?????????2010-10?00--0110---0??1111111110-1------------2------0-?0-110?--0-????????00????01?1???-\
    111????????????10?00000??10????11??????????12-0?00?10??0000??0-??0???--?????????10?0-10?00--0?0-----??---------------------------------10-????0?0-?????100001????1??0---\
    1?1????????????1010?101????????????????????02-1????10??0020??0-1?0110--?????????20?0-10001000?0-----??---------------------------------10-1111-?0-?????1??00110???01110-\
    111101011000-101010000001110---11010100100202-2100010120010000-100110--1011101002010-1000100010-----??---------------------------------10-1111-10-110011000011011101101-\
    111101011000-10101000000?110---11010100100202-1100010110010000-100110--1011101002010-1000100010-----1?---------------------------------10-1111-10-110011000011011101100-\
    111101011000-101010000011110---11010100100202-2100010110030000-100110--1011101002010-1000100010-----11---------------------------------10-1111-10-110011000011011101100-\
    111101011000-101010000000120---11010100100202-2100011--0010-00-100110--1011101002010-1000100010-----11---------------------------------10-1111-00-110011000011011101101-\
    11110?011000-1010100111??110---11010?00100?02-1100010000000000-100110--101110?002010-1000100010-----??---------------------------------10-1111-10-110011000011011101110-\
    11110?011000-101010011111110---11010?00100?02-1100010000000000-100110--101110?002010-1000100010-----??---------------------------------10-1111-10-110011000011011101100-\
    11110?011000-1010100000?0120---11010?00100?02-1100011--0010000-100110--101110?002010-1000100010-----??---------------------------------10-1111-00-110011000011011101110-\
    111?????????????1???-----10????01??????????111-100?10000020??0-001?????11???????00?0?1??00--??0-----??---------------------------------1111111--12?????1??110?1???110-??\
    111????????????110??-----10????01??????????210-100?10?10010100-001??????????????1010?10?00--010-----??---------------------------------10-11?1--??1????1??11001??1?10-??\
    ?11?????????????1???-----10????0????1??????210-1???10?10010??0-001??????????????10?1011?00--010-----??---------------------------------????????-???????????10?1????1????\
    ??1?????????????????-----??????????????????10--????1????0?0??0-??1??????????????20??????0?????0-----??---------------------------------?0-11??--?-?????????10???????????\
    111????????????11??0-----10????01??????????10--100?10000010100-0011?????????????1011010000--010-----??---------------------------------111111?--1?1????????1001??1?10--?\
    11110?01011111011000-----1010000100010?110100--100010000010100-001101101110001001011110000--010-----??---------------------------------1111111--121110011011001111110--1\
    11110?01011111011000-----10100001000?0?110100--100010000010100-00110100111000?0?1011110000--010-----??---------------------------------1111111--121110011011001111110--1\
    11110101011111011000-----10100001000101110100--100010000010100-001101111110001002011010000--010-----11---------------------------------1111111--101110011011001111110--0\
    11110101011111011000-----10100001000101110100--100010000010100-001101111110001002011010000--010-----11---------------------------------1111111--101110011011001111110--0\
    11110101011111011000-----10100001000101110100--100010000010100-001101001110001002011010000--010-----11---------------------------------1111111--111110011011001111110--0\
    111????????????11?0?-----10????0???????????010-?00?10000030?0051?????--?????????10?0-??00110??1??00?????????0-011??0?--000-?-0-0----0--?0-0-0?0-0-????????100????1?????-\
    111????????????110??-----10????????????????010-100?100001-1100-101???--?????????1010-21001101110--01110-------10-------------0-0-----0-?0-0-0?0-0-?111111?10001??1110---\
    111????????????11?00-----10????0???????????00--?00??0??0131?00-??????--?????????1011-2100?--110-----??---------------------------------?0-?????-?-?????????00??????1???-\
    111????????????11?00-----10????0???????????00--?00?10??0130?00-??????--?????????101?-??00?--??0-----??---------------------------------?0-????0-?-?????????00????1?1???-\
    ?11?????????????????-----10?????1??????????00--?00?10000031100-?0????--?????????1010-2000101110-----??---------------------------------?0-????0-?-?????????00??????1???-\
    ?11????????????11?00-----10????01??????????02-0????101100101005001???--?????????1010-210011011110100??????--0-011????-10111?-000----0--?0-0-??0-0-????????100????1?1???-\
    111?????????1??11?0?-----10????0???????110?02-0????101100201003001???--?????????0010-210011011110100??110---1-0101000-101110110102-010-?100-??0-0-?????????00??????1???-\
    111?????????1??11?0?-----10????0???????110?02-0????101100201000001???--?????????0010-210011011110100??110---1-0101000-101111110102-010-?100-??0-0-?????????00??????1???-\
    111????????10??10?01-----10????0???????110?010-?????0?000311002000???--????????10010-20-00--21110100??101---110?011101110??101011000110?10?-?00-0-?????????00????1?1???-\
    111????????10???????-----10????0?????0?100?00--?????0?000211002?0????--????????100??-2?000--??110100??10100011010111000101010?010--010-???????0-?-?????????0?????1?????-\
    111?1??????10?110?01-----10????01100?0?111?010-10??11--0021-002100???--???0????10010-20-010031110100??1010001-010111010001010101100010-?100-?00-0-?11??????00????1?1???-\
    111????????10???0?0?-----10????0???????????010-1????010????0002000???--????????10010-2?-010031110100??101???1-010?11010001010101100010-?100-?00-0-?????????00??????1???-\
    111?????????????0?0?-----10????0???????111?00--????100000201104000???--?????????0011-0?00100311?0?00??101????-010?101-0000-000210----0-?10?00?0-0-?????????00?????11???-\
    111????????????10?0?-----10????0???????111?00--1???100000100104000???--?????????0011-1?100--11110100??1010011-0100101-0000-000210----0-?10?00?0-0-?????????00????1?1???-\
    111?????????????0?0?-----10????0???????111?00--????100000200104000???--?????????0011-1?100--11110100??1011111-0100101-0000-000210----0-?10100?0-0-?????????00??????1???-\
    111110?????111111001-----10????11100?1?111?011-1000100001-?-?0110110?--???0?1??1?1??-??10?????110101000-------111-000-000??1-1-1110100-1???0??0-?-?????1110000??01?????-\
    111?????????0?110??1-----10????0????????????1?????????????0??0?1?0???--???0??????1??-??-1?????1????????-----?-?11??0????0??????11001?0-????????-?-?????????0???????????-\
    111111?0???111011000-----101?0?11100?1?111?011-100010100020-10110110?--11?000??10111-10110--221110110010111111111111000001?101111101111110?00?0-0-?11??1110000??0111???-\
    11111010111101110011-----10111101101011111100--11112---1--0-1040000??--1110111101011-1?01101221{0 1}{0 1}0{0 1}100101000101100101-0000-000110--011101010001-0-01111111-00--001010---\
    11111010111101110011-----10111101101001111110--11112---1--0-1020000??--1110111101011-1?-11012211101100101000101101(1 2)1000001010011121111000-10001-0-01111111-00--101010---\
    11111??????101111011-----10????1???????111?211-11112---1--0-102101???--???0????00111-1?-110122111011??0-----0-111121000001010001121110-00-10001-0-0????111-00--0??01???-\
    111110?????101110011-----?0110001101?1?111?00--11112---1--0-?02000???--???0?1??00011-1?-1101221110110010110111111111000001010011121111100-10001-0-01111111-00--00101???-;";
    

    //hbw
    "00000?00?1000000000?00000001000000?00000000?000000000000??????00100000000101-0201200??00--200100000000100-0000-0-030-0012000000000-0------?-0000000?000??0?0?0000-10-00??0000010000--000000001000-0?01??0-01??30?00-00000000000000300040000000?0?0???0??001?-00101100000---000--00-000----101000000-0021000001100000000000{1234}{01234}0-------------------------------000-0-0-0-----------------------------------------------------------------------------------0????0-------\
    00?00?0????0?000000?00000000000000?0???000000?00000???010???0-?1000000000101-0200--00-00--2001?000000000100000-0-03110012000000000-0------0-00001100000??00??0000-01000??0????11000--00?000001000-0000????01??30000-0000?0001000013000000000011?00??000?00??-00031100001010000--00-000----000?0?010-0021000001100000000000320-------------------------------?00-0-0-0-----------------------------------------------------------------------------------0??000-------\
    0?000?00?1??0?0?000?00?0000100000??00??00000000100000000???????100100000?100-0000--???011-?000100{01}000000100000-0-02110012011-00000-0------0-0000110000?00?????000-01000?00000010010--00000??00100-2000??0-0?????????00??10000000010000010000111000??000?01??-00101200011?0000???00??00----1001?0001-01220001111001000?000?{0123}{0123}0-------------------------------000-0-0-0-----------------------------------------------------------------------------------0????4-------\
    0?000?0???0?0000000?00000001000000??00?00000000?000???00???????1000000000101-0200--00-00--?1011000000000100000-0-23100012011-01000-0------0-0000100000200?????000-0??00?00000010010--000001-00100-2000??0-0????0000-001000000000000000{34}00000111000??000?001?-000311000?1000000--?0?100----100?00011-0121000??1100?000?000?000-------------------------------000-0-0-0-----------------------------------------------------------------------------------0????4-------\
    0?000?0???0?0000000?00000001000000??00?00000000?00?????????????010000000?101-0200--???00--?0011000000000???000-0-2310?0120?1-0000?-0------0-0?00100?00200?????000-0??00?00000010010--000001-00100-2000??0-0????0000-00??000000001000000000??11?000??????????-00101?00001000000--00?100----100???011-0021000??1100?000?000?000-------------------------------000-0-0-0-----------------------------------------------------------------------------------?????4-------\
    0?1?0?0????0100000000000000100000??000?001000000000?000100?????010??0????????0200--???111021010101000000120000-1-0211010-0???20?00-0------0-0?10?10?01?00??0??000-00?00?10000000010--1010?1-0001002011100-011-?0011021??1000????112000300010010010????0?001?-01101100011010?10--110100----30011001--1-22000001000001---1--320-----------------------------00200-0-0-0??---------------------------{01}-0-010101?-----------------------------00---3--02---00??044-------\
    ???????????????????????0000?00000??????0000000??????????????????0?0000???001-0200--???0110?10??101000000??0000-?-?211?1000?0?00000-0------0-0000110?01?00?????000-00?00??0000000010--101001-001?0??0?1??0-011-?0011021??????????0??0000010?00?0010????0?001?-0110120011?????????110?00----30011001--1-43-00?01?-???1---1--320-----------------------------00200-0-0-00----------------------------0-0-010101?-----------------------------00---3--00---0????44-------\
    0?000?00?0?10101000100000001000000?00??00000000????????????????1000000010101-0100--???00--10011101000000120000-0-0211010002000100?-?------?-0000011?01000?????000-0??00??00000?0010--101001-???????01???0-?????0010021??100000000130000??0?00????0??????????-00101200011010?00--0111{01}0----??0110-1--1-44-00-01--0101---1--320-----------------------------00200-0-0-00----------------------------0-0-01??01?-----------------------------00---3--00---0????44-------\
    ????????????????????????????????????????????????????????????????0??010???10???200--????0--?01??1????000????0?0-0-0211010002000?00?-0------0-?00?1?1?011000??00000-0??00?00000000010--101001-00010020111?0-??????001-21??????????01300??010??0??000??????????-?????????????????????????----3001??01--???3-?0????????1---????40-----------------------------?1?00-0-0-0??---------------------------?????10101?-----------------------------00---?--00---0????44-------\
    ???????????????????????????????????????????????????????????????00??110???11????0120???00--?00??101100010??0000-0-?2???1000????????-?------?-00001110?1?00??????00-0??00???00???????????????????????????????????????????????????????0???????????0????????????-?01022??????????????11110----3001?001--1-420?0????-??21---1--?40-----------------------------?1?00-0-0-0??---------------------------???????????-----------------------------00---?--00---0????44-------\
    0?000?0001?0110?000000000001000000??0??000000??????????????????101?110???111?020110???0101?0010101100010??0000-0-221?010002010100?-0------0-0100110001?00?????000-0??00??0000000010--10100??00110020?11?0-?????0010021??1000????013000?010??1??000??????????-00101200011010000--?11100----30011001--1-320?0????0???1---1--210-----------------------------00200-0-0-00----------------------------0-0-010101?-----------------------------00---3--00---0????44-------\
    ?0??0?00?1101000000?00000000000000?0???0?000???0???????????????{01}000{01}00{01}??101-0100--?0-10--200101010001{01}0100100-0-0211010-0100{01}{01}000-0------0-00000100000001??00000-00000?00000010000--00{01}000000000000001?0-01???0000-1100????????{01}1{03}00000001000??00??0000001?-111{01}110000{01}0?0000--00-100----100?00?11-?1{23}{234}000??1?00?000?000?{23}{12}0-------------------------------?00-0-??0-----------------------------------------------------------------------------------100100-------\
    ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????0?0011?00???????????0??0?1101111?????000-0?011??0??0101000--00?00000101?000011???01???????????????????????0102100111???00??????????????????????????????????????????????????????????????????????????????????-??????????????????---???????????????????????????????????????????????????????????????????????????????????????????????????????????\
    000?00?000000000000000000000000000?????000000??0???????????????000000000110?-02010001010--2001110000?100120100-001311010-020011100000200000?001011101110010?00000-01011100000000010--00100000001000011000-01???0000-110010001?000130001000100??000??0?00????011????00001000000--00-0000010100100001?01000000?110?0000000003203301??1-0??-0000110000--01---11000-0-0-00-0000000?010??0---0--?0?--{01}00-0-011?--00----00{01}??00000-0-----00--0??01-??10?------110000000?-?-\
    00000?10?1?0010?000?00000000000000?000?0100010?0?000000100?????010100011?101101012001010--10010100000100120100-001311010-0200111001012000000001010101121110000000-01011100000101120--10100000001000111000-010000110?21001000100011301010001?001001101000000??11111000101000000--00-00000{01}0200110000001010000011000000000002000001101-001-0000011000--01---{123}{23}000-0-0-0110000000?010??0---0--?0?--00110-2110--00----000??00000-0-----00--0??100??10?------110010000?-?-\
    ?0000?1????0?100000?000000000000?00000?01000?000000000010?000-0010??????????1??0??????1???20010???0??1?0???????0?13??01??02000010????????000??1???1?1120010?0?000-0?0111?00001?1120--1010000000100011110???????01?0?21??????1?00????1??0001?1???0????????????11????00101000000--00-00000101001??000?000100000110000??000000000001??1-001-0000001000--01---11000-0-0-0110000000?010??0---0--?0?--00100-2110--00----000??00000-0-----00--0??100??10?------100120000?-?-\
    ?????????????100????00?00?0100000??????0?000?0?????????????????0101000110110102011110-110020010100000200120000-000210010-0200000001010000000012?1?111120010000000-0101?100000102020--10100000101000011000-010000????2?001????00001101011000111111????00?000?011101100011000000--00-000001020111100000010000???000000010001{12}102200121-011-00000100010011---{01}1100-0-0-0120000001?110?????-0--?0?--00100-21??--00----000??00000-0-----00--0??11-00211------0??010000?0?-\
    ???????????????????????????????????????????????????????????????000?00011?10?1??00--???1100200??1??0002?0???0?0-0013??010-0200???000100010000?12?1?1111212?????000-0?0111?10?0102020--101001?0101000?1100??1?????????2???????1??????0201101111???111000??001001?????????1010??0--?0-00000002??1?000100110000001?000000?000?550330?101-0?1-0100100000-??1---44?00-0-0-00-0000000?010??0---0--?0?--000-0-?11?--00----??0??0??00-0-----????0??0????10?------????200?0?-?-\
    ?????00000000001010000000001000????0?110?000????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????0??????0???1000???????????00102011?????1???????????0??????????21?00?????-0??-00101111?11?1?---33100-0-0-00-001111111000?0---0--?0?2?00110-1?1?--00????000??00001010100000--01111-00?11------????21110?00-\
    ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1??????????????????????1??????????????????????????????????????-???-?0000?1110--1?---???00-0-0-00-000?1110101101000101112{12}101110-01??--??????????????????????????????????????------????311?11?0?\
    ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????0??????10111211?0100010100????2111??????????????????????????????????????-??1-?0111111111011---3??00-0-0-00-000021111011210101111122300110-011?--??????????????????????????????????????------????3111??01?\
    ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????0111210001112000010001110000012111??????011????????00?0????00?2??0??????-00?-0000??01?0--0?---3??00-0-0-0??000211101011010001{01}011221110-0-011?--??????????????????????????????????????------0??1311?1000?\
    ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????0??10110??11210??10001110001?13111??????????????????????????????????????-??1-????????????11---3??00-0-0-00-000?111?101121000101?1221110-0-011?--??????????????????????????????????????------????311??000?\
    ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????0??1?1?11-112111110001010001113111????????????????????????????{01}??0??????-011-0011111110--11---3??00-0-0-00-000011111011210101111122300110-011?--??????????????????????????????????????------????311???01?\
    ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1??????????????????????1??????????????????????????????????????-???-??????????????---???00-0-0-00-001121201011110110--?0223101011011?--??????????????????????????????????????------????301?2100?\
    ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????11-112111?10001110101112111??????????????????????????????????????-???-??????????????---???00-0-??00-00{12}121201011110110--?0223001011011?--??????????????????????????????????????------????301?2100?\
    ???????????????????????????????????????????????????????????????010200011?00101011111??111022?111?00002?00-00012121?1??100021-?0100011100?0000120101111212?????000-0?110101000112120--10100000100010000?0??1?????????2????????????1?0201001111?1?1212?11?00000111???110113101?10001111101112111????????55-----------1---1--55?3300110-???-00001001111?1?---34000-0-??00-100121211011110110--?0223101011021?--0?????000??001???10100?00--000100??3??------221?3{02}1?2100-\
    ?110111000000001010000000001000000?1111000002010000000010111101010200011?001010110100-111?22?0111?0002?00-00012121?111100021-201000011000000012010111121211000000-01110101000112120--10100000100010000?0111?0122012?2111111122010110201001111111121211110000011121-11-1{01}010111000111110111??1111-?????55-----------1---1--76?4400??0----------------------44000-0-0-?0-1----?21-011-0---0--?0-23??0-11?21?--0?????0001200120-10100?00--000100??310------0????{02}??????-\
    ?????00????1?21?1-1?1110000110000??000?00000100100????????????1010?0001?????11?00--???12?1000011??0??2?01101???120?1?110?02??10100101200?000?0101???11211?????000-0?0111?10001?1120--201000000???????11?0-???????????1???????????1?01010?011???001??????????01113?210010----11010111{01}01010111101-0000043000001--0000100010{123}{01}0{12}101131-202-0000101?00??0{12}---{12}{12}100-0-0-0100?01000?010??0---0--?0---010-0-1110--00----002??00000-0-----00--0??101??10?------110020010?-?-\
    ?1??0100??1??21?1-??11100011100?0??0001???0?1?0?001000010???1000101000110?0110200--???12?10000?10000?2?01101?0-12021?110?0200101?01012000000?010????11211????0000-0?0111?100???1120--201000000010?1?11??0-??????????21??????????0100{01}0?0?01????0?1??????????011121010010----110101110010101111??100000320000011000001000103303301101-002-000110?000--02---12100-0-0-0100?01000?0?0??0---0--?0---01????01??--?0----00???00000-0-----00--000101??10?------??????01??-?-\
    00000100001112111-10111000011010000000?000001000000??00101?00-0??????????????????????????????????????????????0-121????????????????1?120000?0?0?????????????????????????????????????????????????????????????????21?2221???1102001????????????????????????????011????10010----11010?????10102001??-?000033000???-00?000000005403300???-???-?000?000????01---33?00-0-0-012000100??010??0---0--?0---100-0-0110--00----?????????0-0-----00--?0001-?????------????100?0?-?-\
    ??0??10????112111-?01110??0110100000?01000001000001?000101100-0000?10011????01110--????2???0?????????????????0-121????1??0??????0010???00?00????????????{01}?????????0?0????????????????????????????????????????????122????????2??????01??????1?????1??????????011????10010----????0?????1010?0?1??????0011???????0000???????44033?????-???-?00011100???0?---23?00-0-0-0120001000?010??0---0--?0---100-0-011?--00----??{02}??0000??0-----00--000001??10?------????200?0?-?-\
    ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????011????10110----1101011?0?????2111?????????????????0??????????1?01??????-001-000011100???0?---1??00-0-0-0100?01000?010??0---0--?0---010-0-1110--0????????????????0-----????????????10?------????20010?-?-\
    ???????????????????????????110100??????????????????????????????????????????????1??????11?0????????0??0?10-0???????2??????????20?????????????????????11211100??000-0101?11??00111?20--??100000001?00111?20-????0?????2????????????????0111???0???????????000?011111110010----11010111101020210111??10013???????-00?000??0003202201101-001-010000210???01---22000-0-0-0120001000?010??0---0--?0---100-0-1110--10----000??0002??0-----00--000101??10?------110010000?-?-\
    ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????11211?00??000-0101111??00111120--1?100000001?0011??00-0?000?????2????????????????0111???????????101100??011????10010----110101111010202001????10002????????????001000032011011?1-10?-010001110???0?---33000-0-0-0120001000?010??0---0--?0---{01}00-0-11??--10----000??0002??0-----00--000101??10?------????10000?-?-\
    ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????011????10110----0101010??011113111???????0?????????????????0114?02??????-01?-0000111100--0?---3??00-0-0-010000111102000-0---0--00---01110-111?--00----0001201000-111000011?000100??10?------????20110?-?-\
    ?????000101112111-10111111111?1000001111?0002101001??0110002111?10??????????????????????????????????????????????11????????????????1????000?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????0----??????????1??????1??????0011000????0000???????0000??????-11?-010011110???0?---0??00-0-0-013000?211?1000-0---0--00---000-0-1???--10----00???01000-100---00--???1???????------????211?0?-0-\
    ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????0??????10010----?10101110011112111????????????????????????????0??2?????1-001-00001111????0?---00000-0-0-0130001111?1000-0---0--00---000-0-111?--10----0011201000-100---00--1111????10?------????21110?-0-\
    ?1?0001?????121?1-1?11111111111000011011?110210?001??01100021110102000???11110200--???11?1010??1?????2?0?????0-011?1??10-?200???00111??00?00????????11211?????11100??1???2000110111??20?00??????0???1???????????????2???????????1?1011-0????1???????????????011131010010----?10101110011110111??0?1001220000?1000000100010{12}3?{24}{34}0010?-??1-?0001111?0?011---00000-0-0-0130001111?1000-0---0--00---000-0-1???--10----0001201000-100---00--011?00?????------????211?0?-0-\
    ?1100010101112111-10111101{01}1111000000011111011000011001111?1111?10?0??????????????????11???????????????????1?0-011????10-?????????1112000000???0????1?211?????11100?0??1??0001121210020100??0101???1111?0-??????????21??????????????????????????????????????01111?010010----?1010111001111011111????0022000????0000????0101?03??????-???-?100???100--01---01000-0-0-0130001111?2000-0---0--000--00110-1110--??-???????????????????????????????????------????21110?-?-\
    ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????011????101111101010001110001112111??????001????????0000????0010?00??????-00?-?0000001????11---0??00-0-0-00-000011101011011?00--00001100-0-0110--??-???????????????????????????????????------????3111100??\
    ???????????????????????????????????????????????????????????????0102000?1?11??000??????11100100111?000000??0?00-0??3???10002???????111001????????110?1121??????11100?{01}11???????01021?02?111??01010?111???????????????21{03}?????????1?30????????????????????????011101111-11?10?1???01110001111111??-111???3000001-????0000????20?1??111-?11-0111??2100--01---33000?0-0-00-001021211000-0---0--00000100-0-00?0--00----001121---??101102011100001-??00-------??????1?????-\
    0????01????112011-1??1110?00111000??001111101110101???11??????1????????????????????????????1?011????????1????0-0?1???0??????????1?1?11000000????????1121221011?11001?1?1????011?02????0111?????1??10???0????????????????????????????????????????????????????01111?01001111010100011100???13011?????0???????????????0010???0001101111-001-00000011????11---00100-0-0-013000011211000-0---0--00000100-0-01??--00----00112010010101000010100001-??210------100?21110?0?-\
    ???????????????????????????111100??????????????????????????????0???????????????????????????????????????0????????????????????????????????????????????11212210111110010??1????01??1210????11??0?01??101??0??01?????????????????????????01?????????????????00??011101110111110101000111000111301111?00000110000???0000001000100014?1001-001-01000011?0--11---00100-0-0-00-000011211000-0---0--00000100-0-0110--00----00112010010101111010100001-??210------100021110?0?-\
    ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????0111{012}1{01}100111101110011010000112111??????001????????00?????????21011??111-001-0110001100--01---22?00-0-0-0100{01}0211101011011000--00001010-0-0110--00----00{01}120000101010000111111100??110------????3111100?-\
    01111?11--1112111-1011110100111100001011110011101011001101??0-?000200011?11110201111??110021000100000100110000-00{01}3100100020020100011000000000?0111111212201?111100?0111110001021210020111000111001011100-01000?????21??????????013000111011??11111110010010011111111-111101010011010001112111??010001310000000000000100015403300101-002-0100000100--11---33000-0-0-00-000111102011000?-0--01101100-0-01??--0100?0000??0000??10100000--00011-??211------100031111000-\
    ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1001????????????110?????111????????????????????????????{12}?0???????-???-??????????????---2??00-0-0-010000211201011010000--11101{01}10-0-01?0--?100?0000110000101010000111111?1-00211------????31111010-\
    ?????011--1112101-112?11112?2211111???11?1???1000121??11000?110????????????????00--???1??????????????????????0-0?1???????02?????1????????????????????????????????????????????????????????????????????????????????????????????????????????????????1??????????01113101??113101?100010???10113111???0110011??000??00000000000?1?00?????-1??-??????????????---?3?00-0-0-0100?011?201?110110010?111?1010-0-011?--?1???1?????0001??1010???1???111???????------????31111010-\
    ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1??????????????????????????????????????-???-??????????????---?3?00-0-0-0??0000111010?12????????????110-?-????--0100201101200101010100001111?1?1-00211------????311?1010-\
    ?????????????????????????????????????????????????1211?110??????00?2101-----??0200--????20001-10100000200??0?00-0{01}12??010-02?????11?112010?1??11???1011212?1???11100?0221?21?1-1?0210?2?100?????1?01011??0-????1?????21??????????????1012????????01??????00??011111111-11310111001101001?113011??0?000021000????10??000000032011?????-101-??????????????---33200-0-0-00-0002112010110110010011101100-0-0110--010{01}101100-000010101000001011011-00211------100031112010-\
    ????101????112101-1?21111120221111?01011?111111101??????????110000??0????????0100--???12?001???1???002?1???000-0013??010-02???0?110112010010?11?1?1011212?????1110???2???2101-??0????211??00???10?1??1??????????????21???????????1?01??????1???102??????????0?????11??113101110011010011113111????00???????????????000????32011?????-001-??????????????---33200-0-0-00-0100112110112110011111213101-1001??--01111111010001010101000011010111-11211------????31111010-\
    ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????01111111011?????1???????10????3111??????0?1????????00??????0003?01??????-10?-??????????????---3?200-0-0-00-0101111110112110011111203100-1001?0--0101211101200101010100100--1?111-00211------????31111010-\
    11111011--1112101-1121110120221111?1101111111111012111110002??00002101-----100110--111120001-1011000020?120100-0?121101000201302110112010011011?111011212310??11100?-211?2?01-1?0210121100001--1011011110-??00{12}?????21??????2???11301??3-0010011011110110011011111111-11310110--110100111131111101000010000????1000000000032011?????-101-??????????????---33200-0-0-01001001121101121110111112{12}?010-10011?--0102101101200111110110{01}11{01}010111-00211------????31112010-\
    11111011--1112101-1121110120221111?1101111111111012111110002??00002101-----100110--111120021-11110000201110000-0?1211010-02013021101120100110111011011212310??111001-22112101-1?0211120100001--1001011110-1-01?1????21201111201211001013-0011011011111??0010011111111-11311110--11010010113{01}11110101011000000111000000000032022------001------------------33200-0-0-00-0100112110112111011111223110-0-0110--01121011012001111101101111010111-0?211------221131111110-\
    1111101????11210??1?21?1????22100????????????????????????????????0??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????01?1111??????????????10?1????11111110100011000?0?110000001000021?001011?-011-0?00100100???1---33?00-0-0-0??0?001?1???1??110?1???1????10-0-??1?--?101211001200001010100001?0?1111-00211------????311?2010-\
    11?11011--1112001-1021110120221010011011?1112110011?21111002??0?0??101-----????00--????2?0??-1?1?????????????0-0?1???010-?2?????11?????1??10?????????????????????????????????????????????????????????????????????????????????????????????????????1??????????011101210111110100--11010?00112111??01011110000001100?000000002100010??1-111-0000110100--01---33?00-0-0-010000???1?10110110?11?11?13010-0-011?--01?1{01}01101200?01?10{01}0??00--?0111-001?1------????3?1120??-\
    ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????11212?10111111011??11???1-1102101??111??0111??101??0??1-??0?????2????????????????0?1????????????????000?011111110011?1{01}1010011011000112111????????????????????????????2100010{12}10-01?-0000110100??0?---33200-0-0-0100000111010110110011111103010-0-011?--01111110012000010101000011110111-00211------100031111010-\
    01111??????????????????????????0101???????????10122?21111002??00002101-----????00--1??120?21-?110????200120100-00131?010-12013021101020101100110111111212?????11111?-21112011-1?021??20110000111?010110?0-1-??1?????21??????3013??3011-201?1001?12111?01????0111{234}1?11-1111{01}1010011-10010113111??010000100000011000?001?01132011?1110-10?-0000110100??0?---33200-0-0-00-0010212110110110011011112110-0-011?--0111111000-000010101001011111111-00211------????31111010-\
    ??11111??????2?01-1??111112022101001111??1112111?1212110-002??00102101-----010{02}00--???120011-10100001100110100-0111111110020030111010101011101101111112123?011111110-21112011-1-021002111?000111001111110-1-??{12}?????21??????30121100101200111010021111??????011111111-111101110011110011111111111101012{23}000??11011{12}001001032011111{01}0-111-01100121?0--0?---33200-0-0-012001021211011211{01}?11111223110-0-011?--011110110{01}2001210100---00--11111-00211------????3?112010-\
    ?1??1?1?????12001-1?21111?2022101000?011?1112110??2121110002???0002101-----???10???????2??2?-101010002?0??0100-10131?010-12??30????10201011?0????111112123?0111?1110-21112011-?-0?10020110001--10?1011{01}0??????1??????????????01??0?01????1?100?012??????000?011111111-?1110??1--?10???10113111??11000110000001?000000000003201100100-111-0000100100--??---33200-0-0-00-0?0?????1?11?1???????1??3?10-0-?11?--0111211100-000010101001011011111-00211------????31111010-\
    11111?11-?1?12?01?1021110?10???????0100111?12?1?1?1?2100-1?????0002101?????110010?????1210?1?1?1110002100-0000-01001?111002??3011?010111001001110?1111212???1101??????2?1201????0????10???0?????1???110?1????????????1??????4??221001????1?1000112??????00??0110---11-11210?11001100001121301111-1-01-33110111-01121---1--5303210101-?01-0111102100--01---33200-0-0-00-1---2121-0110100011-11223100-0-01??--011?1011?0-01121-0-0---10--00001-01211------????311121100\
    ??????????????????????????????????????0???????11?11?210111??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????011101211-11110?1100110000???0301111-1-?1-441--1----1121---1--6404310211------0100021?0--01---33200-0-0000-{01}-1021211011010001110122?100-0-0110--?11{01}10110{01}{12}00120-0-0---00--00011-00211------????3?112010?\
    11111{01}11--1112101-1011111120221010111001111121101221211110021100?02101-----101110--111120?21-11100000201121100-02120-11000201302110101010110011011101121231?11111110-22112011-1-0210120111000111001011110-1-00211111212011114113110020120011111112111101001?011111111-11110110--1101000111311111000000320000011000001100104402310110-00?-0011110000--01---33200-0-0-00-00011121101121--011111223110-0-0110--01011101011001010110---00--00011-11211------221131111110-\
    11111011-?1112101-102111112022111001110110111101222?211100021102102101-----101010--110121100-011010002000-1000-021-0-01000201301110100110110012111111121231011111010-21{01}?2001-1-021011010?011--1011?11010-1-0021112221201?11311221302013-011111?021011111-1?0111{123}1?11-11110110--00-0001111{01}111??--??-?55-----------?????????0????101-0??-???1????00--0?---??010-0-0-00-?????????????????????--????0-0-0110--0????-????????????????????????01-0010-------????51?-----0\
    ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?????????????????????????????????--????????????????????????????00-10100??---------------------------?-?-????--?-----------------------------??---?--------?02?44-------\
    ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1??????1?4?1??1???-112???????7?4??--???------202----00--011104??00-10100??---------------------------?-?-????--?-----------------------------???--?--------?02?44-------\
    ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????--????????????????????????????00-10100??---------------------------????????--?-----------------------------???--?--------????5?------?\
    ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1??????????????????1??????????????--????????????????????????????1111?101??---------------------------????????--?-----------------------------???--?--------?2115?------?\
    ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1??????????1??1???-11???????????5?--????------------?-??-----???11110100??---------------------------0-0-0010--?-----------------------------01---0--------100154------0\
    ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?????????????????????????????????--????????????????????????????11111101??---------------------------????????--?-----------------------------???--?--------?2115?------?\
    ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1010211??1??????????????????????1??????1-4????????-112????1--6?15?--????---------------------2??110111{01}00----------------------------0-0-0010--?-----------------------------01---0--------100154------0\
    ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1010211??1??????????????????????1??????1-4????????-112????1--6?13?--????2-2101?1----00--02---4??110111{01}0??---------------------------0-0-0010--?-----------------------------01---0--------100154------0\
    ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????101112-1??????????1110?????1001??????1-4????????-1?2????1--6?1??--????-----?????--?-??-????2??1?????????---------------------------?????0??--?-----------------------------???--?--------????5?------?\
    ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????101112-1??????????1110?????1001??????1-4????????-1?1????1--6????--?????-??0???----?-??-2???2??1?????????---------------------------?????0??--?-----------------------------???--?--------????5?------?\
    ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?????????????????????????????????--????????????????????????????11110110??---------------------------????????--?-----------------------------???--0--------{12}02154------0\
    ???????????????????????????????????????????????????????????????000101001101111001011101110001111011000000-1000-01221101000200001001111101000200?11001111111111111011-12111010112121??101000101110000111210????3?????21?????1????1120002110001100010010110100?????????????????????????????????1??-1--???3110???-????1---????4??4--231???????????????????????2?11110100??---------------------------????????--0-----------------------------01-??3----0---221155------1\
    ???????????????????????????????????????????????????????????????000101001101111001011101110001111011000000-1000-01221101000200001001111101000200?11001111111111111011-12111010112121??101000101110000111210????3?????21?????1????1120002110001100010010110100?????????????????????????????????1??-1-0???3110???-????1---????4??2--100???????????????????????4?11110100??---------------------------????????--0-----------------------------01-??3----0---221155------1\
    ??????????????????????????????????????????????????????????????????2101-----01000{01}00110?100?1-11000000??0?????1112?{01}???100?2??21??001?1????1??0??1?1?11211????0000-0101210?????1?1?????011000???10?{01}0??1???00?????????????????1?????1?01????1????????????000?011101111-10----011?010100102011{01}11?{01}{01}{01}01-420100000?10201011--4{23}{01}{12}{01}--10101-100102----01110100044?00-0-0-00----------------------------0-0-01?0100-----------------------------01---1--0?0--10???44-------\
    ???????????????????????????????????????????????????????????????????????????????????????1?0??????????????????????2????????0??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????110101011-10----111101110010201001???1?01-42000-000-10?1-??1--{45}2?{12}0--00101-110202----01110100144100-0-0-00----------------------------0-0-01??0?0-----------------------------01---1--0010110???44-------\
    ?????01???????????0????10?00000?????1?1111112011101100110?02???0002101-----11121111???12000?-1112001?0010-00?1112110-110002??1110011111000001021111111211??0????100??121020?021212100?01110101110001?11???????0?????????????????210010221011???00111101100??110101111-10----111?0111001120100111?1-01-43-10-01?-10?1---1--63131--00131-211202----01000112144100-0-0-00----------------------------0-0-0110420-----------------------------01---1--201111210?44-------\
    ??10?????????10?????2?0100??00?????????????????????????????????101?101-----??10?0--???1200?2-??11?0000?0?????111202??010102??1????0?10?000?0?????????1??????????????????????????????????????????????????????????????????????????01011????001???00???????????110101011-10----111?011100011{01}20011111-01-43-10-110-1121---1--76144--2211-----002----00--0110044100-0-0-00----------------------------0-0-011?420-----------------------------01---3--221211110?44-------\
    ?????010001??11?1-?021110001000??????1?????????????????????????1012101-----1110?120???120?02-111100000000-0111112120-0100021-?1100011010000001211111112?110000000-0?01210200021112100101000101?110?1?11???000022112?21??1???2????10120221011??100???????01??110101111-10----111?011100011120011111-01-43-10-?11-1121---1--76144--2322-----0-2----00--0210044100-0-0-00----------------------------0-0-01??320-----------------------------01---?--2012111???44-------\
    ?0?00010?011111?1-1?21?10000000?1??01111?1102011101000110?021102112101-----01020110110121001-11100011000120111112110-1111121-111001111?0000010211111112011?0??0010011121020002121210010111010101102111120-00012?????21211???2???2110202210111010011210110000110101111-10----111?011100112010011111-01-43-11-110-1121---1--63131--11111-211102----0???0011144100-0-0-00----------------------------0-0-0???1{12}0-----------------------------01---?--101111110?44-------\
    ??????1?????????????????????000?????0??1?111?1????1?111101????02112101-----01020110????{12}10?1-111010110000-01111?2010-111112??1110011111000001021111111211?????????0??121?20002121210010???010110???1?0??????????????????????????21102022?111???00???????????110102111-10----111?01110011201001??11-01-43-11-110-1121---1--64132--23111-211002----01010110044100-0-0-00----------------------------0-0-01?0210-----------------------------01---?--101211????44-------\
    ???0001???????????1????100?????????0???1?110??????1?001101?????0002101-----?1000110110121001-??10001110012011111211??0101121-1110011111000?0102111111121110?00??10010121020002121210010?110101?110?1?0????00012?11???1??????????21102022111111?0011?1011000?111102111-10----111?011100112010011111-01-43-11-?10-11?1---1--63131--22111-211002----01010110144{12}00-0-0-00----------------------------0-0-0???110-----------------------------01---?--1011011???44-------\
    ???00?1???????????1??1?110?0????1?101??11110?0?????????????????0002101-----?1000121110121001-0110001100112011111211100101121-111001111100010?02111111121110000??1001?121020002121210010?1101011110?1?0????00012?????????????????1110201211111110011?1011000?111101111-10----111?011100112010011111-01-43-11-110-11?1---1--63131--22111-211?02----01010110144?00-0-0-00----------------------------0-0-0???310-----------------------------01---?--201211????44-------\
    ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?????????201?000??10???????-?????--2??0?-??0?00----?0--0?0-0??100-0-0-00----------------------------0-0-0???120-----------------------------01---{12}--??0--1????43-------\
    ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????0111011?001????????????000????0001??1???10220000011010?????000??00?--????1-2?0000----00--01?-033200-0-0-00----------------------------0-0-01??220-----------------------------01---?--010--1????43-------\
    ??????1?????1???????????????????0????0?1?0??100000??????????0-??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1101???11-11010111?001000010201001????-?1-4{34}???????-1021---1--75143--100?---?-100----0101010-044?00-0-0-00----------------------------0-0-0010420-----------------------------?1---0--2?0--1????43-------\
    11111010001111001-10110100?0?010100?0111?010201?001??0110111111????????????????????????1???????????1??????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?????????????????????????????????????010????1??10----?0??0111?0112010011100001-420000000-10101011--42?10--0?1?1-1?0?02----0???0?00044?00-0-0-00----------------------------0-0-0110200-----------------------------01---?--110--1????44-------\
    11?11010001111001-1011010020?010100?{01}1?11110201?001??0110111111?????????????????1?0????2?1??????????1??0?????1?1??1??????0??????00111210?000??????????????????????????????????????????????????????????????????????????????????1????0????????????????????????010101111-10----10?2011100112010011111-01-42?10-000-1011---1--52120--1{01}101-110202----01000?11144000-0-0-00----------------------------0-0-01??110-----------------------------01---?--{01}01101????44-------;";
  
    mpl_matrix* m = mpl_matrix_new();
    mpl_matrix_set_nrows(ntax, m);
    mpl_matrix_set_ncols(nchar, m);
    mpl_matrix_set_nnodes(2 * ntax, m);
    mpl_matrix_attach_rawdata(rawmatrix, m);
    //    mpl_matrix_set_gap_handle(GAP_MISSING, m);
    mpl_matrix_apply_data(m);
    mpl_init_parsimony(m);
    
    mpl_search s;
    s.treelist = mpl_treelist_new(ntax, 100000, 0);
    s.num_taxa = ntax;
    s.bbreak_type = MPL_TBR_T;
    
    mpl_bbreak bbk;
    // The number of nodes in the bbreak will be the size of the tree
    bbk.num_nodes = 2 * ntax-1;
    // Now the bbkreak struct can be initialised
    mpl_bbreak_init(&s, &bbk);
    bbk.bbktype = MPL_TBR_T;
    bbk.numreps = 10;
    //    bbk.bbktype = MPL_SPR_T;
    mpl_do_bbreak(&bbk);
    
    mpl_tree* t  = mpl_new_tree(ntax);
    mpl_topol* top = NULL;
    char* nwkresult = NULL;
    int i = 0;
    
    for (i = 0; i < bbk.treelist->num_trees; ++i) {
        top =  mpl_treelist_get_topol(i, bbk.treelist);
        mpl_tree_read_topol(t, top);
        
        mpl_tree_write_newick(&nwkresult, t);
        printf("TREE Morphy_%i = [&U] %s [length: %.0f]\n", i+1, nwkresult, top->score);
        free(nwkresult);
    }
    
    return failn;
}
